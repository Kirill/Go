# Программа курса Разработка на Go

## Модуль 1. Начало работы с Go  - 1 месяц

### 1.1 Начало работы c Go
* Установка компилятора и тулчейна
* Создание проекта на Go. GOPATH
* Компиляция и запуск программ на Go
* Подключение библиотек
* Основные синтаксические конструкции
* Публичные и приватные идентификаторы

*Домашнее задание*

Завести Go репозиторий на GitHub, написать программу печатающую текущее время / точное время с использованием библиотеки NTP

### 1.2 Элементарные типы данных в Go
* Элементарные типы
* Zero value
* Константы
* Указатели
* Строки и руны и массивы байтов
* Стандартный функции для работы со строками и Unicode
* Преобразование и присвоение типов
* Передача по ссылке и значению

*Домашнее задание*

Создать Go функцию, осуществляющую примитивное сжатие строки, содержащей повторяющиеся символы / руны, например: "aaaabccddddde"  => "a4bc2d5e"

### 1.3 Слайсы и словари
* Отличия массивов и слайсов
* Внутренняя структура слайсов и словарей
* Создание и работа со слайсами и словарями
* Отличие длинны и емкости (length vs capacity)
* Различные способы итерации
* Сортировка
* Распространне ошибки и затруднения

*Домашнее задание*

Написать функцию, которая получает на вход текст и возвращает
10 самых часто встречающихся слов без учета словоформ

### 1.4 Функции и обработка ошибок
* Функции и области видимости 
* Замыкания
* Функции с переменным числом аргументов
* Типы ошибок
* panic, recover и defer
* Стректрейсы
* Best practiсe обработки ошибок

*Домашнее задание*

Написать функцию находящую максимальный элемент в слайсе 
с произвольными элементами ([]interface{}) с использованием
пользовательской функции-компаратора.

### 1.5 Структуры
* Определение структур
* Вложенные и анонимные структуры
* Тэги элементов структуры
* Использование тэгов для JSON и работы с СУБД
* Публичные структуры и публичные элементы структур
* Методы типов 

*Домашнее задание*

Реализовать двусвязанный список на языке Go

### 1.6 Интерфейсы
* Определение и реализация интерфейсов
* Внутренняя структура интерфейсов
* Интерфейсы как "универсальный" тип
* Определение типа значения интерфейса
* Опасный и безопасный type cast
* Конструкций switch 
* Слайсы и словари с интерфейсами
* Где мои generic-и ???!!!

*Домашнее задание*

Реализовать функцию json_path, получающую на вход JSON документ,
путь в это документе и возвращающую значение по данному пути.
Обработать возможные ошибки.

### 1.7 Горутины и каналы
* Запуск горутин
* Каналы, внутреняя структура канала
* Буферизованные и небуферизованные каналы
* Операции работы с каналами
* Использование каналов для передачи данных и синхронизации
* Конструкция select
* Таймеры в Go

*Домашнее задание*

Написать функцию, объединяющую несколько каналов в один. Принимает слайс с каналами `[]chan interface{}`, возвращает один канал `chan interface{}`

### 1.8 Примитивы синхронизации
* Мьютексы
* Условные переменные
* Гарантировано одноразовое выполнение
* Pool и WaitGroup
* Модель памяти в Go
* Race-детектор

*Домашнее задание*

Сделать функцию для параллельного выполнения N заданий.
Принимает на вход слайс с заданиями `[]func()error`, число заданий которые можно выполнять параллельно `N` и максимальное число ошибок после которого нужно приостановить обработку. Учесть что задания могу выполняться разное время.

### 1.9 Пакеты и библиотеки 
* Импорт пакетов
* Алиасы и импорт без использования
* init функции и порядок инициализации пакетов
* internal пакеты
* Рекомендованная структура проекта

*Домашнее задание*

Оформить функции из домашних заданий 1.2 и 1.3 в виде отдельного проекта.
Сделать интерфейс командной строки CLI для вызова этих функций.

## Модуль 2. Стандартные библиотеки и практики - 1 месяц

### 2.1 Инструменты Go разработчика
* Подробнее про GOROOT и GOPATH
* Сборка модулей и установка программ: go build, go install
* Модули и зависимости: dep и vgo
* Форматирование кода: go fmt, fix
* Линтеры: go vet, golint, металинтеры

*Домашнее задание*

Оформить программу из задания 1.1 в виде GitHub проекта.
Описать и проверить установку зависимостей с помощью dep.
Настроить и запустить линтеры, создать Makefile для автоматизации проверки и сборки проекта

### 2.2 Работа с вводом/выводом
* Тип Buffer
* Стандартные интерфейсы: Reader, Scanner, Writer, Closer
* Блочные устройства, Seeker
* Форматированный ввод и вывод: fmt

*Домашнее задание*

Реализовать утилиту копирования файлов (см man dd).
Выводить в консоль прогресс копирования

### 2.3 Форматирование данных
* base64 и другие форматы строк, кодировки
* Текстовые форматы: JSON, XML, YAML
* Использование стуктур и интерфейсов для парсинга
* Бинарные форматы: MsgPack и ProtocolBuffers

*Домашнее задание*

Сделать утилиту консольную утилиту для кодирования, декодирования JWT токенов

### 2.4 Взаимодействие с OS
* Обработка аргументов командной строки: flags, cobra
* Работа с переменными окружения
* Запуск внешних программ
* Работа с файловой системой
* Временные файлы
* Обработка сигналов

*Домашнее задание*

Реализовать утилиту envdir на Go.
Эта утилита позволяет запускать программы получая переменные окружения из определенной директории. См man envdir

### 2.5 Файлы конфигурации и логирование
* Различные варианты конфигурации
* Использование простых форматов: ini, yaml и т.п.
* Библиотеки для работы с конфигурацией: viper и confita
* Стандартная библиотека для логирования
* Расширенное логирование с помощью Zap

*Домашнее задание*

Реализовать "каркас" микросервиса, считывающий конфиг из файла,
создающий логгер/логгеры с указанными уровнями детализации.

### 2.6 Рефлексия
* Использование пакета reflect
* Type и Value
* Использование рефлексии совместно с type switch
* Пакет unsafe и тип unsafe.Pointer
* Пример использования рефлексии

*Домашнее задание*

Сделать простой JSON сериализатор: функцию, которая принимает `interface{}` и возвращает строку, содержащую JSON. Учитывать тэги структур.


### 2.7 Кодогенерация в Go
* Примеры применения кодогенерации
* Команда go generate
* Генерация кода по Protobuf спецификациям

*Домашнее задание*

Сделать "заготовку" для микросервиса-календаря. Определить структуру определяющую событие, написать методы для добавления/изменения/удаления событий. Хранить события в памяти, без персистентности.

### 2.8 Профилирование и оптимизация Go программ
* Общая информация о профилировании
* Виды профайлеров
* Профилирование использования  CPU
* Профилирование выделения памяти
* Flame диаграммы
* Общие оптмизации в Go
* Оптимизации выделения памяти

*Домашнее задание*

Провести анализ производительности программы из дз 2.6.
Построить Flame диаграммы и выявить наиболее медленные фрагменты.
Попытаться улучшить производительность.

## Модуль 3 Cетевое взаимодействие - 1 месяц

### 3.1 Go Internals
* Как работает планировщик в Go
* Блокирующие и неблокирующие вызовы
* Goroutines and Threads
* Вызовы С функций в Go, CGO

*Домашнее задание*

Выяснить на каком IP адресе содержится больше всего доменов из зоны .by
Сравнить скорость работы с использованием CGO и Pure-Go DNS resolver.
Сравнить количество потоков и нагрузку на систему.
Список доменов: http://csa.ee/databases-domain-lists/

### 3.2 Низкоуровневые протоколы TCP, UDP, DNS
* Стандартные интерфейсы - Dialer, Conn
* Возможные сетевые проблемы: потеря пакетов, подвисшие соединения, недоступность
* Таймауты и контекст
* Отладка сетевых проблем

*Домашнее задание*

Реализовать telnet клиент (см man telnet)

### 3.3 HTTP библиотека
* Использование HTTP клиента
* Создание простого HTTP сервера
* Декораторы и middleware
* HTTP/1.1 и HTTP/2.0
* REST
* Протокол S3

*Домашнее задание*

Используя go-swagger сделать REST сервер и CLI клиент для сервиса-календаря из дз 2.7. Поскольку swagger генерирует занчительную часть кода имеет смысл сделать это отдельным проектом.

### 3.4 GRPC
* Описание API с помощью Protobuf
* Генерация кода для GRPC клиента и сервера
* Реализация API
* Прямая и обратная совместимость API
* Представление о Clean Architecture

*Домашнее задание*

Создать GRPC спецификацию для сервиса-календаря из дз 2.7.
Сгенерировать GRPC сервер и клиент, проверить работу сервиса.
Отделить модель данных от Protobuf структур.

### 3.5 Работа с SQL 
* Стандартные интерфейсы sql.DB, sql.Rows, sql.Tx
* Подключение к СУБД и настройка пула подключений
* Выполнение запросов и получение результатов
* Простейшие SQL запросы

*Домашнее задание*

Изменить код сервиса-календаря, так что бы события хранились в базе данных.

### 3.6 Продвинутая работа с базами
* Использование sqlx хелперов
* Работа с NULL значениями
* Использование транзакций
* Миграция баз данных

*Домашнее задание*

Изменить код сервиса-календаря, добавить поддержку событий "на весь день". Использовать sqlx. Написать миграции для базы данных.

### 3.7 NoSQL базы данных
* Встроенные базы данных, BoltDB
* Использование Redis для кеширования данных
* Выбор базы данных для проекта

*Домашнее задание*

Реализовать методы "события на текущую неделю" и "события на текущий месяц", кешировать результаты выбороки в Redis


### 3.8 Очереди сообщений
* Использование RabbitMQ, Kafka
* Возможные проблемы с очередями: перегрузка, падение обработчиков, сбойные сообщения
* Запуск пула обработчиков с помощью systemd или supervisor

*Домашнее задание*

Реализовать "напоминания" о событиях с помощью RabbitMQ.
Создать процесс, который периодически сканирует основную базу данных, выбирая события о которых нужно напомнить. Создать процесс, который читает сообщения из очереди и шлет уведомления.

## Модуль 4 Микросервисы

### 4.1 Монолит и микросервисы
* Отличия микросервисов от монолитной архитектуры
* Преимущества микросервисов
* 12 factor applications
* Архитектура одного микросервиса
* Clean Architecture

*Домашнее задание*

Доработать дз 3.8, разделив код на отдельные сервисы

### 4.2 Docker
* Основные команды docker
* Представление о контейнер и образе
* Сборка собственных Docker контейнеров
* Запуск и управление контейнерами
* Передача конфигурации и получение логов
* Использование Docker Registry

*Домашнее задание*

Подготовить Docker файлы для каждого из сервисов из дз 3.8.
Собрать образы и загрузить в DockerHub

### 4.3 Тестирование микросервисов
* Использование docker-compose
* Интеграционные тесты
* Behaviour Driven Development
* Описание тестов на языке Gherkin
* Использование godog для запуска тестов

*Домашнее задание*

Создать docker-compose файл, поднимающий все сервисы проекта, включая базу и очередь. Написать простейший интеграционный тест для проекта.

### 4.4 Kubernetes ?
* Docker Swarm ?
* Puppet ?
* Ansible ? 
* Как мы решаем проблему запуска сервсисов на более 1 машины ?

*Домашнее задание*

Развернуть проект в Kubernetes. Создать описания pod-ов и service-ов.
Избавиться от hard-code IP в конфигах проектов.

### 4.5 Обнаружение сервисов
* Необходимость Service Discovery
* Использование DNS
* Использование DCS: zookeeper, etcd, consul

*Домашнее задание*

Продолжение дз 4.4

### 4.6 Мониторинг
* Проверка работоспособности сервисов
* Health Check в Docker
* Системные метрики: LA, CPU, MEM, IO
* Количественный мониторинг, prometheus

*Домашнее задание*

Обеспечить простейший мониторинг проекта с помощью prometheus

### 4.7 Использование CI
GitLab pipelines

*Домашнее задание*

Автоматизировать тестирование и выкатку новых версий с помощью CI

### 4.8 ??

## Модуль 5. Практика / проетная работа.
### 5.1
### 5.2
### 5.3
### 5.4
### 5.5
### 5.6
### 5.7
### 5.8
